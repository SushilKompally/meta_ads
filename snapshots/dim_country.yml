version: 2

snapshots:
  - name: dim_country
    description: "SCD Type 2 snapshot for Meta Ads countries using timestamp-based strategy."

    columns:
      - name: ma_country_id
        description: "Natural/business key for the country."
        data_type: varchar

      - name: country_name
        description: "Full name of the country (e.g., United States, India)."
        data_type: varchar

      - name: country_code
        description: "ISO-style country code from Meta Ads."
        data_type: varchar

      - name: currency
        description: "Primary currency used in the country."
        data_type: varchar

      - name: timezone
        description: "Timezone associated with the country."
        data_type: varchar

      - name: updated_at
        description: "Last modified timestamp used for SCD2 tracking (coalesced with silver_load_date)."
        data_type: timestamp_ntz

      - name: silver_load_date
        description: "Timestamp when the record was loaded into the Silver layer."
        data_type: timestamp_ltz