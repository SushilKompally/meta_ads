version: 2

snapshots:
  - name: dim_creative
    description: "SCD Type 2 snapshot for Meta Ads creatives using timestamp-based strategy."

    columns:
      - name: ma_creative_id
        description: "Natural/business key for the creative asset."
        data_type: varchar

      - name: name
        description: "Creative name/title assigned in Meta Ads."
        data_type: varchar

      - name: title
        description: "Primary title for the creative."
        data_type: varchar

      - name: body
        description: "Body text or primary message of the creative."
        data_type: varchar

      - name: image_url
        description: "URL of the creative image asset."
        data_type: varchar

      - name: video_url
        description: "URL of the creative video asset."
        data_type: varchar

      - name: url
        description: "Destination or preview URL used in the creative."
        data_type: varchar

      - name: updated_at
        description: "Timestamp used for SCD2 tracking (coalesced with silver_load_date)."
        data_type: timestamp_ntz

      - name: silver_load_date
        description: "Timestamp when the record was loaded into the Silver layer."
        data_type: timestamp_ltz