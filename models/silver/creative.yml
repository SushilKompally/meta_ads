version: 2

models:
  - name: creative
    description: >
      Silver layer table for Meta Ads Creatives. Transformed from bronze with standardized
      naming, safe casting, soft-delete flag, and audit timestamp.
    config:
      contract:
        enforced: true

    columns:
      - name: ma_creative_id
        description: "Primary key for the Meta Ads Creative (from CREATIVEID)."
        data_type: varchar
        tests:
          - not_null
          - unique

      - name: name
        description: "Internal or display name of the creative (from NAME)."
        data_type: varchar

      - name: title
        description: "Title/headline of the creative (from TITLE)."
        data_type: varchar

      - name: body
        description: "Body/description text of the creative (from BODY)."
        data_type: varchar

      - name: image_url
        description: "Image asset URL used by the creative (from IMAGEURL)."
        data_type: varchar

      - name: video_url
        description: "Video asset URL used by the creative (from VIDEOURL)."
        data_type: varchar

      - name: url
        description: "Destination URL or landing page (from URL)."
        data_type: varchar

      - name: status
        description: "Lifecycle status of the creative (from STATUS)."
        data_type: varchar

      - name: updated_at
        description: "Last update timestamp from source (from UPDATEDAT)."
        data_type: timestamp_ntz

      - name: is_deleted
        description: "True if STATUS is 'DELETED', else false."
        data_type: boolean
        tests:
          - not_null
          - accepted_values:
              values: [true, false]

      - name: silver_load_date
        description: "Ingestion timestamp for the silver layer."
        data_type: timestamp_ntz
        tests:
          - not_null